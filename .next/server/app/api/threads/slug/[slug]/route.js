"use strict";(()=>{var t={};t.id=3807,t.ids=[3807],t.modules={20399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4211:(t,e,o)=>{o.r(e),o.d(e,{originalPathname:()=>m,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>g});var r={};o.r(r),o.d(r,{GET:()=>u,dynamic:()=>i});var a=o(49303),l=o(88716),n=o(60670),s=o(87070),d=o(67097);let i="force-dynamic";async function u(t,{params:e}){try{let{slug:t}=e;console.log(`Fetching thread by slug: ${t}`);let o=null;try{o=await (0,d.G8)(t)}catch(t){return console.error("Failed to load thread data from Lighthouse:",t),s.NextResponse.json({success:!1,error:"Failed to load thread data from storage"},{status:500})}if(o&&o.thread&&(console.log(`Slug lookup: Found thread "${o.thread.title}" with ${o.comments.length} comments`),console.log("Slug lookup: Thread reply IDs:",o.comments.map(t=>t.id))),console.log("DEBUG: Loaded thread data:",{hasData:!!o,hasThread:!!o?.thread,hasComments:!!o?.comments,commentCount:o?.comments?.length||0,threadTitle:o?.thread?.title}),!o||!o.thread)return console.log("No thread data found after retries"),s.NextResponse.json({success:!1,error:"No thread found"},{status:404});let{thread:r,comments:a}=o;return console.log(`Thread found: ${r.title} (${r.id})`),console.log(`Thread has ${a.length} comments`),console.log("Comment IDs:",a.map(t=>t.id)),console.log("Thread data structure:",{id:r.id,title:r.title,slug:r.slug,replyCount:r.replyCount,actualComments:a.length,lastReply:r.lastReply,lastActivity:r.lastActivity}),s.NextResponse.json({success:!0,thread:{id:r.id,slug:r.slug,title:r.title,op:r.op,replies:a,lastReply:r.lastReply,replyCount:r.replyCount||0,imageCount:r.imageCount||0,videoCount:r.videoCount||0,createdAt:r.createdAt,lastActivity:r.lastActivity,authorWallet:r.authorWallet}})}catch(t){return console.error("Error fetching thread by slug:",t),s.NextResponse.json({success:!1,error:"Failed to fetch thread"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:l.x.APP_ROUTE,page:"/api/threads/slug/[slug]/route",pathname:"/api/threads/slug/[slug]",filename:"route",bundlePath:"app/api/threads/slug/[slug]/route"},resolvedPagePath:"/Users/meneer.groot/GitHub/LOOPCHAN/app/api/threads/slug/[slug]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:p}=c,m="/api/threads/slug/[slug]/route";function y(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:g})}},67097:(t,e,o)=>{o.d(e,{G8:()=>s,Ij:()=>n,Oo:()=>a,gK:()=>l});let r={threads:[],totalThreads:0,lastUpdated:new Date().toISOString()};async function a(){try{return console.log("Loading all threads from memory..."),console.log(`âœ… Loaded ${r.threads.length} threads from memory`),r}catch(t){return console.error("Error loading threads:",t),{threads:[],totalThreads:0,lastUpdated:new Date().toISOString()}}}async function l(t){try{console.log("Creating thread with data:",{id:t.id,title:t.title,slug:t.slug}),r.threads.unshift({id:t.id,slug:t.slug,title:t.title,createdAt:t.createdAt.toISOString(),lastActivity:t.lastActivity.toISOString(),replyCount:t.replyCount,imageCount:t.imageCount,videoCount:t.videoCount,op:{content:t.op.content,image:t.op.image,video:t.op.video,authorWallet:t.op.authorWallet,timestamp:t.op.timestamp.toISOString()},authorWallet:t.authorWallet}),console.log(`ðŸ“Œ NEW THREAD: "${t.title}" added to TOP of board (position 0)`),console.log(`Board now has ${r.threads.length} threads`),r.threads.length>100&&(console.log(`ðŸ§¹ CLEANUP: Removing ${r.threads.length-100} old threads (threads 101+)...`),r.threads=r.threads.slice(0,100),console.log(`âœ… CLEANUP: Removed old threads. Board now has ${r.threads.length} threads (max 100)`)),r.totalThreads=r.threads.length,r.lastUpdated=new Date().toISOString(),console.log("âœ… Thread created successfully in memory")}catch(t){throw console.error("Error creating thread:",t),console.error("Error details:",{message:t instanceof Error?t.message:"Unknown error",stack:t instanceof Error?t.stack:void 0}),t}}async function n(t){try{console.log(`Loading thread by ID: ${t}`);let e=r.threads.find(e=>e.id===t);if(!e)return console.log(`Thread ${t} not found`),null;let o={id:e.id,slug:e.slug,title:e.title,op:{content:"Thread content would be loaded here",authorWallet:"unknown",timestamp:new Date(e.createdAt)},replyCount:e.replyCount,imageCount:e.imageCount,videoCount:e.videoCount,createdAt:new Date(e.createdAt),lastActivity:new Date(e.lastActivity),authorWallet:"unknown"};return console.log(`âœ… Found thread: ${o.title}`),o}catch(e){return console.error(`Error loading thread ${t}:`,e),null}}async function s(t){try{console.log(`Loading thread by slug: ${t}`);let e=r.threads.find(e=>e.slug===t);if(!e)return console.log(`Thread with slug ${t} not found`),null;let o={id:e.id,slug:e.slug,title:e.title,op:{content:"Thread content would be loaded here",authorWallet:"unknown",timestamp:new Date(e.createdAt)},replyCount:e.replyCount,imageCount:e.imageCount,videoCount:e.videoCount,createdAt:new Date(e.createdAt),lastActivity:new Date(e.lastActivity),authorWallet:"unknown"};return console.log(`âœ… Found thread: ${o.title}`),{thread:o,comments:[]}}catch(e){return console.error(`Error loading thread ${t}:`,e),null}}}};var e=require("../../../../../webpack-runtime.js");e.C(t);var o=t=>e(e.s=t),r=e.X(0,[9276,5972],()=>o(4211));module.exports=r})();