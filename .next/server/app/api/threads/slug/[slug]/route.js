"use strict";(()=>{var e={};e.id=3807,e.ids=[3807],e.modules={38013:e=>{e.exports=require("mongodb")},11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},76162:e=>{e.exports=require("stream")},4211:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>m,patchFetch:()=>y,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var r={};o.r(r),o.d(r,{GET:()=>i,dynamic:()=>d});var s=o(49303),a=o(88716),l=o(60670),n=o(87070),u=o(29342);let d="force-dynamic";async function i(e,{params:t}){try{let{slug:e}=t;console.log(`Fetching thread by slug: ${e}`);let o=null;try{o=await (0,u.G8)(e)}catch(e){return console.error("Failed to load thread data from MongoDB:",e),n.NextResponse.json({success:!1,error:"Failed to load thread data from storage"},{status:500})}if(o&&o.thread&&(console.log(`Slug lookup: Found thread "${o.thread.title}" with ${o.comments.length} comments`),console.log("Slug lookup: Thread reply IDs:",o.comments.map(e=>e.id))),console.log("DEBUG: Loaded thread data:",{hasData:!!o,hasThread:!!o?.thread,hasComments:!!o?.comments,commentCount:o?.comments?.length||0,threadTitle:o?.thread?.title}),!o||!o.thread)return console.log("No thread data found after retries"),n.NextResponse.json({success:!1,error:"No thread found"},{status:404});let{thread:r,comments:s}=o;return console.log(`Thread found: ${r.title} (${r.id})`),console.log(`Thread has ${s.length} comments`),console.log("Comment IDs:",s.map(e=>e.id)),console.log("Thread data structure:",{id:r.id,title:r.title,slug:r.slug,replyCount:r.replyCount,actualComments:s.length,lastReply:r.lastReply,lastActivity:r.lastActivity}),n.NextResponse.json({success:!0,thread:{id:r.id,slug:r.slug,title:r.title,op:r.op,replies:s,lastReply:r.lastReply,replyCount:r.replyCount||0,imageCount:r.imageCount||0,videoCount:r.videoCount||0,createdAt:r.createdAt,lastActivity:r.lastActivity,authorWallet:r.authorWallet}})}catch(e){return console.error("Error fetching thread by slug:",e),n.NextResponse.json({success:!1,error:"Failed to fetch thread"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/threads/slug/[slug]/route",pathname:"/api/threads/slug/[slug]",filename:"route",bundlePath:"app/api/threads/slug/[slug]/route"},resolvedPagePath:"/Users/meneer.groot/GitHub/LOOPCHAN/app/api/threads/slug/[slug]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:h,serverHooks:g}=c,m="/api/threads/slug/[slug]/route";function y(){return(0,l.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[9276,5972,9342],()=>o(4211));module.exports=r})();