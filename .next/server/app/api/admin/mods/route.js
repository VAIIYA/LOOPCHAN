"use strict";(()=>{var e={};e.id=6052,e.ids=[6052],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78662:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y});var n={};r.r(n),r.d(n,{GET:()=>l,POST:()=>p,dynamic:()=>u});var a=r(49303),o=r(88716),i=r(60670),s=r(87070),d=r(90528);let u="force-dynamic";async function l(e){try{let t=e.headers.get("x-admin-wallet");if(!t||!(0,d.GJ)(t))return s.NextResponse.json({error:"Unauthorized. Admin access required."},{status:403});let r=await (0,d.Jw)();return s.NextResponse.json({success:!0,mods:r})}catch(e){return console.error("Get mods error:",e),s.NextResponse.json({error:"Failed to get mods"},{status:500})}}async function p(e){try{let t=e.headers.get("x-admin-wallet");if(!t||!(0,d.GJ)(t))return s.NextResponse.json({error:"Unauthorized. Admin access required."},{status:403});let{action:r,walletAddress:n}=await e.json();if(!r||!n)return s.NextResponse.json({error:"Missing required fields: action, walletAddress"},{status:400});if("add"===r)try{let e=await (0,d.vg)(n,t);return s.NextResponse.json({success:!0,mod:e})}catch(e){return s.NextResponse.json({error:e instanceof Error?e.message:"Failed to add mod"},{status:400})}else if("remove"!==r)return s.NextResponse.json({error:'Invalid action. Must be "add" or "remove"'},{status:400});else try{if(await (0,d.bW)(n))return s.NextResponse.json({success:!0,message:"Mod removed successfully"});return s.NextResponse.json({error:"Mod not found"},{status:404})}catch(e){return s.NextResponse.json({error:e instanceof Error?e.message:"Failed to remove mod"},{status:400})}}catch(e){return console.error("Mod management error:",e),s.NextResponse.json({error:"Failed to manage mod"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/mods/route",pathname:"/api/admin/mods",filename:"route",bundlePath:"app/api/admin/mods/route"},resolvedPagePath:"/Users/meneer.groot/GitHub/LOOPCHAN/app/api/admin/mods/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:y,serverHooks:f}=m,g="/api/admin/mods/route";function w(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}},90528:(e,t,r)=>{r.d(t,{GJ:()=>u,Jw:()=>m,UY:()=>p,bW:()=>y,j9:()=>i,md:()=>s,vg:()=>c});var n=r(75637),a=r(11185),o=r.n(a);let i="2sRhKuPffCwT2uuGVu3DXDsLFmjv78uKkEMd9UYrF5jv",s=.01;async function d(){if(!o().connections[0].readyState){if(!process.env.MONGODB_URI)throw Error("MONGODB_URI is not defined");await o().connect(process.env.MONGODB_URI)}}function u(e){return"2Z9eW3nwa2GZUM1JzXdfBK1MN57RPA2PrhuTREEZ31VY"===e}async function l(e){if(u(e))return!0;try{return await d(),!!await n.Mod.findOne({walletAddress:e}).lean()}catch(e){return console.error("Error checking if wallet is mod:",e),!1}}async function p(e){return u(e)||await l(e)}async function m(){return await d(),await n.Mod.find({}).sort({addedAt:-1}).lean()}async function c(e,t){if(await d(),await n.Mod.findOne({walletAddress:e}))throw Error("Wallet is already a mod");let r=new n.Mod({walletAddress:e,addedBy:t});return await r.save(),r}async function y(e){if(await d(),u(e))throw Error("Cannot remove admin");return(await n.Mod.deleteOne({walletAddress:e})).deletedCount>0}},75637:(e,t,r)=>{r.r(t),r.d(t,{File:()=>y,Mod:()=>g,Post:()=>c,Thread:()=>m,User:()=>p,UserProfile:()=>f});var n=r(11185),a=r.n(n);let o=new(a()).Schema({email:{type:String,required:!0,unique:!0,lowercase:!0,trim:!0},password:{type:String,required:!0},name:{type:String,default:"Anonymous"},createdAt:{type:Date,default:Date.now}},{timestamps:!0}),i=new(a()).Schema({id:{type:String,required:!0,unique:!0},threadId:{type:String,required:!0,index:!0},content:{type:String,default:null},imageFileId:{type:a().Schema.Types.ObjectId,ref:"File",default:null},videoFileId:{type:a().Schema.Types.ObjectId,ref:"File",default:null},authorId:{type:String,required:!0},isAnonymous:{type:Boolean,default:!0},timestamp:{type:Date,default:Date.now,index:!0}},{timestamps:!0}),s=new(a()).Schema({id:{type:String,required:!0,unique:!0},slug:{type:String,required:!0,unique:!0,index:!0},title:{type:String,required:!0},opPostId:{type:String,required:!0},authorId:{type:String,required:!0},replyCount:{type:Number,default:0},imageCount:{type:Number,default:0},videoCount:{type:Number,default:0},lastActivity:{type:Date,default:Date.now,index:!0},createdAt:{type:Date,default:Date.now,index:!0}},{timestamps:!0}),d=new(a()).Schema({filename:{type:String,required:!0},contentType:{type:String,required:!0},size:{type:Number,required:!0},uploadedAt:{type:Date,default:Date.now,index:!0},uploadedBy:{type:String,required:!0},gridFSFileId:{type:a().Schema.Types.ObjectId,required:!0},isDeleted:{type:Boolean,default:!1}},{timestamps:!0}),u=new(a()).Schema({walletAddress:{type:String,required:!0,unique:!0,index:!0},username:{type:String,default:null,maxlength:50},location:{type:String,default:null,maxlength:100},socialLinks:{x:{type:String,default:null},youtube:{type:String,default:null}},bio:{type:String,default:null,maxlength:500},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}},{timestamps:!0}),l=new(a()).Schema({walletAddress:{type:String,required:!0,unique:!0,index:!0},addedBy:{type:String,required:!0},addedAt:{type:Date,default:Date.now}},{timestamps:!0}),p=a().models.User||a().model("User",o),m=a().models.Thread||a().model("Thread",s),c=a().models.Post||a().model("Post",i),y=a().models.File||a().model("File",d),f=a().models.UserProfile||a().model("UserProfile",u),g=a().models.Mod||a().model("Mod",l)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[9276,5972],()=>r(78662));module.exports=n})();