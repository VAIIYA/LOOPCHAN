"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[987],{9763:function(e,t,r){r.d(t,{Z:function(){return i}});var a=r(2265),o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),i=(e,t)=>{let r=(0,a.forwardRef)((r,i)=>{let{color:s="currentColor",size:l=24,strokeWidth:d=2,absoluteStrokeWidth:c,className:h="",children:u,...g}=r;return(0,a.createElement)("svg",{ref:i,...o,width:l,height:l,stroke:s,strokeWidth:c?24*Number(d)/Number(l):d,className:["lucide","lucide-".concat(n(e)),h].join(" "),...g},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])});return r.displayName="".concat(e),r}},2660:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3113:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},3417:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},9374:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]])},2489:function(e,t,r){r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},1079:function(e,t,r){r.d(t,{s:function(){return g}});var a=r(7437),o=r(2265),n=r(9763);let i=(0,n.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var s=r(9374),l=r(3113),d=r(2489);let c=(0,n.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var h=r(7526),u=r(9376);let g=e=>{let{isReply:t=!1,onSubmit:r,onCancel:n}=e,{data:g,status:m}=(0,h.kP)(),p=(0,u.useRouter)(),[f,y]=(0,o.useState)(""),[x,b]=(0,o.useState)(""),[v,w]=(0,o.useState)(null),[j,k]=(0,o.useState)(!1),N=async e=>{if(e.preventDefault(),"unauthenticated"===m||!g){p.push("/auth/signin");return}if(t){if(!(null==f?void 0:f.trim())&&!v){alert("Please provide either a comment, image, or video");return}}else{if(!x.trim()){alert("Please provide a thread title");return}if(!(null==f?void 0:f.trim())&&!v){alert("Please provide either a comment, image, or video");return}}k(!0);try{try{await r({content:f.trim()||null,title:t?null:x.trim()||null,image:(null==v?void 0:v.type.startsWith("image/"))?v:null,video:(null==v?void 0:v.type.startsWith("video/"))?v:null})}catch(e){throw console.error("Error in onSubmit callback:",e),e}y(""),b(""),w(null)}catch(e){console.error("Failed to submit post:",e),alert("Failed to submit post. Please try again.")}finally{k(!1)}};return"unauthenticated"!==m&&g?(0,a.jsxs)("div",{className:"bg-white border border-orange-200 rounded-lg p-6 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:t?"Post Reply":"Start New Thread"}),n&&(0,a.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 transition-colors",children:(0,a.jsx)(d.Z,{size:20})})]}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[!t&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),(0,a.jsx)("input",{type:"text",value:x,onChange:e=>b(e.target.value),placeholder:"Thread title...",className:"w-full bg-orange-50 border border-orange-300 rounded-lg px-3 py-2 text-gray-800 placeholder-gray-500 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none",style:{fontSize:"16px"},required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comment"}),(0,a.jsx)("textarea",{value:f,onChange:e=>y(e.target.value),placeholder:"Type your message here... (optional)",rows:6,className:"w-full bg-orange-50 border border-orange-300 rounded-lg px-3 py-2 text-gray-800 placeholder-gray-500 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none resize-none",style:{fontSize:"16px"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:(()=>{if(!v)return"Media (optional)";let e=v.type.startsWith("video/");return"".concat(e?"Video":"Image"," (").concat(v.name,")")})()}),(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png,.gif,.webp,.webm,.mp4,.mov,video/webm,video/mp4,video/quicktime,image/jpeg,image/png,image/gif,image/webp",capture:"environment",onChange:e=>{try{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){let e=["video/webm","video/mp4","video/quicktime"];if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp",...e].includes(r.type)){alert("File type not allowed. Please select a JPG, PNG, GIF, WebP image or WebM/MP4/MOV video.");return}let t=e.includes(r.type),a=t?10485760:5242880;if(r.size>a){alert("File too large. Maximum size for ".concat(t?"videos":"images",": ").concat(a/1048576,"MB"));return}w(r)}}catch(e){console.error("Error handling file change:",e),alert("Error processing file. Please try again.")}},className:"w-full bg-orange-50 border border-orange-300 rounded-lg px-3 py-2 text-gray-800 placeholder-gray-500 focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none",style:{fontSize:"16px"}}),(0,a.jsx)("div",{className:"absolute right-3 top-2.5 text-orange-400",children:v?v.type.startsWith("video/")?(0,a.jsx)(s.Z,{size:18}):(0,a.jsx)(l.Z,{size:18}):(0,a.jsx)(i,{size:18})})]})}),(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:"Images: JPG, PNG, GIF, WebP (max 5MB) | Videos: WebM, MP4, MOV (max 10MB)"}),v&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-green-600",children:["Selected: ",v.name," (",(v.size/1048576).toFixed(2),"MB)"]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("button",{type:"submit",disabled:!(null==f?void 0:f.trim())&&!v||!t&&!x.trim()||j,className:"flex items-center space-x-2 bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg min-h-[44px] touch-manipulation",style:{fontSize:"16px"},children:[(0,a.jsx)(c,{size:18}),(0,a.jsx)("span",{children:j?"Posting...":t?"Post Reply":"Create Thread"})]})})]})]}):(0,a.jsx)("div",{className:"bg-white border border-orange-200 rounded-lg p-6 shadow-md",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Sign In Required"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"You need to sign in to create threads and post replies."}),(0,a.jsx)("button",{onClick:()=>p.push("/auth/signin"),className:"bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white px-6 py-2 rounded-lg",children:"Sign In"})]})})}},8223:function(e,t,r){r.d(t,{s:function(){return a}});class a{static async uploadFile(e){try{let t=new FormData;t.append("file",e);let r=await fetch("/api/upload",{method:"POST",body:t});if(!r.ok){let e=await r.json().catch(()=>({error:"Upload failed"}));throw Error(e.error||"Failed to upload file")}let a=await r.json();return console.log("File upload successful:",a),a}catch(e){throw console.error("File upload failed:",e),e}}static async createThread(e){console.log("Creating thread:",e);try{let t=await fetch("/api/threads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("Thread creation response status:",t.status),!t.ok){let e=await t.json().catch(()=>({error:"Failed to create thread"}));throw console.error("Thread creation error:",e),console.error("Response status:",t.status),console.error("Response headers:",Object.fromEntries(t.headers.entries())),Error(e.error||"Failed to create thread")}let r=await t.json();if(console.log("Thread creation result:",r),!r.success||!r.thread)throw console.error("Invalid thread creation result:",r),Error("Invalid response from server");return r}catch(e){throw console.error("Thread creation request failed:",e),e}}static async getThreads(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log("Fetching threads, page:",e);try{let t=await fetch("/api/threads?page=".concat(e));if(!t.ok)return console.error("Failed to get threads, status:",t.status),{threads:[],page:e,totalPages:0,totalThreads:0};let r=await t.json();return console.log("Threads result:",r),r}catch(t){return console.error("Get threads request failed:",t),{threads:[],page:e,totalPages:0,totalThreads:0}}}static async createPost(e){console.log("Creating post:",e);let t=await fetch("/api/threads/".concat(e.threadId,"/posts"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Failed to create post"}))).error||"Failed to create post");return t.json()}static async getThread(e){try{let t=await fetch("/api/threads/".concat(e),{cache:"no-store",headers:{"Cache-Control":"no-cache"}});if(!t.ok){if(404===t.status)return{success:!1,error:"Thread not found"};let e=await t.json().catch(()=>({error:"Failed to get thread"}));return{success:!1,error:e.error||"Failed to get thread"}}return await t.json()}catch(e){return{success:!1,error:"Failed to load thread"}}}}}}]);