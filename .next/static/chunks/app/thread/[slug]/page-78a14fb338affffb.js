(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[535],{2538:function(e,t,a){Promise.resolve().then(a.bind(a,7915))},7915:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var s=a(7437),r=a(2265),n=a(9376),o=a(8325);function l(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),[a,l]=(0,r.useState)(null),[c,i]=(0,r.useState)(!0),[d,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(0),g=e.slug,x=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{console.log("Attempting to load thread by slug: ".concat(g," (attempt ").concat(e,")"));let s=await fetch("/api/threads/slug/".concat(g),{cache:"no-store",headers:{"Cache-Control":"no-cache"}});if(!s.ok){if(404===s.status)throw Error("Thread not found");throw Error("HTTP ".concat(s.status,": ").concat(s.statusText))}let r=await s.json();if(r.success&&r.thread){var t,a;console.log("Thread loaded successfully: ".concat(r.thread.title)),console.log("Thread has ".concat((null===(t=r.thread.replies)||void 0===t?void 0:t.length)||0," replies")),console.log("Reply IDs:",(null===(a=r.thread.replies)||void 0===a?void 0:a.map(e=>e.id))||[]),l(r.thread),u(null),m(0)}else throw Error(r.error||"Failed to load thread")}catch(a){let t=a instanceof Error?a.message:"Unknown error";if(console.error("Thread load attempt ".concat(e," failed:"),t),e<10){let t=Math.min(1e3*Math.pow(1.5,e-1),1e4);console.log("Thread not found, retrying in ".concat(t,"ms... (attempt ").concat(e,"/10)")),setTimeout(()=>{m(e),x(e+1)},t)}else console.error("All retry attempts failed"),u(t),m(e)}finally{i(!1)}};return((0,r.useEffect)(()=>{g&&x()},[g]),c)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading thread..."}),h>0&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Retry attempt ",h,"/10"]})]})}):d?(0,s.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md w-full mx-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Thread Not Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"The requested thread could not be found."}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>t.push("/"),className:"bg-orange-500 text-white px-6 py-2 rounded hover:bg-orange-600 transition-colors",children:"Back to Homepage"}),(0,s.jsx)("button",{onClick:()=>{i(!0),u(null),m(0),x()},className:"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600 transition-colors",children:"Try Again"})]})]})}):a?(0,s.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,s.jsx)(o.s,{thread:a,onBack:()=>t.push("/")})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-gray-600",children:"No thread data available"})})})}},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[526,987,325,971,117,744],function(){return e(e.s=2538)}),_N_E=e.O()}]);