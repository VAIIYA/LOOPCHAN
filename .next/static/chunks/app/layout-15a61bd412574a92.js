(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6643:function(e,o,t){Promise.resolve().then(t.t.bind(t,4742,23)),Promise.resolve().then(t.bind(t,6541)),Promise.resolve().then(t.t.bind(t,5660,23))},6541:function(e,o,t){"use strict";t.d(o,{O:function(){return r},WalletProvider:function(){return i}});var n=t(7437),l=t(2265),c=t(2957).lW;let a=(0,l.createContext)(void 0),r=()=>{let e=(0,l.useContext)(a);if(!e)throw console.error("useWallet must be used within a WalletProvider"),Error("useWallet must be used within a WalletProvider");return e},i=e=>{let{children:o}=e,[t,r]=(0,l.useState)({publicKey:"",connected:!1,connecting:!1});(0,l.useEffect)(()=>{(()=>{try{{let e=localStorage.getItem("loopchan-wallet");if(e)try{let o=JSON.parse(e);console.log("Loading saved wallet state:",o),r(o)}catch(e){console.error("Failed to parse saved wallet state:",e),localStorage.removeItem("loopchan-wallet")}}}catch(e){console.error("Error loading wallet state:",e),r({publicKey:"",connected:!1,connecting:!1}),localStorage.removeItem("loopchan-wallet")}})()},[]),(0,l.useEffect)(()=>{try{t.connected?(localStorage.setItem("loopchan-wallet",JSON.stringify(t)),console.log("Wallet state saved to localStorage")):(localStorage.removeItem("loopchan-wallet"),console.log("Wallet state removed from localStorage"))}catch(e){console.error("Error saving wallet state to localStorage:",e)}},[t]),(0,l.useEffect)(()=>{(()=>{try{if("solana"in window){let e=window.solana;if((null==e?void 0:e.isPhantom)&&e.isConnected&&!t.connected){let o=e.publicKey.toString();console.log("Auto-detected connected wallet:",o),r({publicKey:o,connected:!0,connecting:!1})}}}catch(e){console.error("Error checking wallet availability:",e)}})();let e=()=>{try{let e=window.solana;if(null==e?void 0:e.isConnected){let o=e.publicKey.toString();console.log("Wallet connected event:",o);let t={publicKey:o,connected:!0,connecting:!1};r(t),localStorage.setItem("loopchan-wallet",JSON.stringify(t))}}catch(e){console.error("Error handling wallet connect event:",e)}},o=()=>{try{console.log("Wallet disconnected event"),r({publicKey:"",connected:!1,connecting:!1}),localStorage.removeItem("loopchan-wallet")}catch(e){console.error("Error handling wallet disconnect event:",e)}};try{if("solana"in window){let t=window.solana;return null==t||t.on("connect",e),null==t||t.on("disconnect",o),()=>{null==t||t.off("connect",e),null==t||t.off("disconnect",o)}}}catch(e){console.error("Error setting up wallet event listeners:",e)}},[t.connected]),(0,l.useEffect)(()=>{let e=()=>{try{if("solana"in window){let e=window.solana;if((null==e?void 0:e.isPhantom)&&e.isConnected){let o=e.publicKey.toString(),n=localStorage.getItem("loopchan-wallet");if(n)try{let e=JSON.parse(n);e.connected&&e.publicKey===o&&(!t.connected||t.publicKey!==o)&&(console.log("Restoring wallet state on page load:",o),r({publicKey:o,connected:!0,connecting:!1}))}catch(e){console.error("Error parsing saved wallet on page load:",e)}}}}catch(e){console.error("Error checking wallet on page load:",e)}};e();let o=setTimeout(e,100);return()=>clearTimeout(o)},[]);let i=async()=>{try{if(r(e=>({...e,connecting:!0})),"solana"in window){let e=window.solana;if(null==e?void 0:e.isPhantom)try{let o=(await e.connect()).publicKey.toString(),t={publicKey:o,connected:!0,connecting:!1};r(t),localStorage.setItem("loopchan-wallet",JSON.stringify(t)),console.log("Wallet connected successfully:",o)}catch(e){throw console.error("Phantom connect failed:",e),e}else console.warn("Phantom wallet not detected"),window.open("https://phantom.app/","_blank")}else console.warn("Solana wallet not available"),window.open("https://phantom.app/","_blank")}catch(e){throw console.error("Failed to connect wallet:",e),r(e=>({...e,connecting:!1})),e}},s=async e=>{try{if(!t.connected)throw Error("Wallet not connected");if("solana"in window){let o=window.solana;if(!(null==o?void 0:o.isPhantom))throw Error("Phantom wallet not available");let t=new TextEncoder().encode(e),n=await o.signMessage(t,"utf8");if(!(null==n?void 0:n.signature))throw Error("No signature received from wallet");let l=c.from(n.signature).toString("base64");return console.log("Message signed successfully"),l}throw Error("Solana wallet not available")}catch(e){throw console.error("Failed to sign message:",e),e}};return(0,n.jsx)(a.Provider,{value:{wallet:t,connect:i,disconnect:()=>{try{if("solana"in window){let e=window.solana;null==e||e.disconnect()}r({publicKey:"",connected:!1,connecting:!1}),localStorage.removeItem("loopchan-wallet"),console.log("Wallet disconnected successfully")}catch(e){console.error("Error disconnecting wallet:",e),r({publicKey:"",connected:!1,connecting:!1}),localStorage.removeItem("loopchan-wallet")}},signMessage:s},children:o})}},5660:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[130,957,971,117,744],function(){return e(e.s=6643)}),_N_E=e.O()}]);